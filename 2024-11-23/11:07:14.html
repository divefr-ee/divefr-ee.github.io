<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="icons/favicon.ico">
    <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="120x120" href="icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="167x167" href="icons/apple-touch-icon-167x167.png">
    <link rel="apple-touch-icon" sizes="512x512" href="icons/apple-touch-icon-512x512.png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>divefree: Ulua Beach</title>
    <script src="/plotly-basic.min.js"></script>
    <style>
        html {
          height: 100%;
          margin: 0;
          overflow: hidden;
        }
        body {
          height: 100%;
          font-family: Arial, sans-serif;
          color: #555;
          overflow-y: auto;
          overflow-x: hidden;
        }
        #divePlot {
          width: 100%;
        }
        #mapPane {
          width: 100%;
        }
    </style>
  </head>
  <body>
    
    <div id="divePlot"></div>
    
    <br/>

    <div id="mapPane">
      <center>
        <iframe
            id="mapIframe"
            width="70%"
            height="200px"
            loading="lazy"
            frameborder="0"
            scrolling="no"
            src="https://www.openstreetmap.org/export/embed.html?bbox=-156.4743%2C20.65886%2C-156.4143%2C20.71886&marker=20.68886,-156.4443">
        </iframe>
      </center>
    </div>
    
    <script>
      const title = '';
      const xlabel = 'time (s)';
      const ylabel1 = 'depth (m)';
      const ylabel2 = 'rate (m/s)';
      const color1 = 'royalblue';
      const color2 = 'grey';
      const dataset = {
        date: "2024-11-23",
        time: "11:07:14",
        lat: 20.68886,
        lon: -156.4443,
        locname: "Ulua Beach",
        t: [0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75,24,24.25,24.5,24.75,25,25.25,25.5,25.75,26,26.25,26.5,26.75,27,27.25,27.5,27.75,28,28.25,28.5,28.75,29,29.25,29.5,29.75,30,30.25,30.5,30.75,31,31.25,31.5,31.75,32,32.25,32.5,32.75,33,33.25,33.5,33.75,34,34.25,34.5,34.75,35,35.25,35.5,35.75,36,36.25,36.5,36.75,37,37.25,37.5,37.75,38,38.25,38.5,38.75,39,39.25,39.5,39.75,40,40.25,40.5,40.75,41,41.25,41.5,41.75,42,42.25,42.5,42.75,43,43.25,43.5,43.75,44,44.25,44.5,44.75,45,45.25,45.5,45.75,46,46.25,46.5,46.75,47,47.25,47.5,47.75,48,48.25,48.5,48.75,49,49.25,49.5,49.75,50,50.25,50.5,50.75,51,51.25,51.5,51.75,52,52.25,52.5,52.75,53,53.25,53.5,53.75,54,54.25,54.5,54.75,55,55.25,55.5,55.75,56,56.25,56.5,56.75,57,57.25,57.5,57.75,58,58.25,58.5,58.75,59,59.25,59.5,59.75,60,60.25,60.5,60.75,61,61.25,61.5,61.75,62,62.25,62.5,62.75,63,63.25,63.5,63.75,64,64.25,64.5,64.75,65,65.25,65.5,65.75,66],
        depth: [-0.3,-0.92,-1.26,-1.45,-1.09,-0.82,-1.13,-1.25,-1.63,-1.78,-1.87,-1.91,-1.9,-1.9,-1.9,-1.88,-1.91,-1.98,-2.04,-2.04,-2.05,-2.05,-2.05,-2.04,-2.05,-2.05,-2.04,-2.04,-2.06,-2.06,-2.05,-2.05,-2.04,-2.05,-2.05,-2.06,-2.07,-2.06,-2.07,-2.06,-2.06,-2.07,-2.06,-2.06,-2.07,-2.08,-2.09,-2.1,-2.09,-2.11,-2.1,-2.11,-2.1,-2.09,-2.09,-2.06,-2.05,-2.04,-2.04,-2.04,-2.03,-2.01,-1.99,-1.99,-2,-2,-2.02,-2.04,-2.05,-2.06,-2.07,-2.07,-2.06,-2.05,-2.04,-2.04,-2.03,-2.04,-2.04,-2.05,-2.05,-2.03,-2.01,-2.02,-2.01,-2.01,-2.01,-2.02,-2.02,-2.02,-2.02,-2,-1.99,-1.98,-1.99,-1.99,-1.97,-1.96,-1.96,-1.98,-2,-2.03,-2.07,-2.1,-2.14,-2.16,-2.16,-2.21,-2.23,-2.26,-2.3,-2.31,-2.32,-2.32,-2.32,-2.3,-2.29,-2.27,-2.24,-2.21,-2.18,-2.16,-2.13,-2.08,-2.04,-2,-1.99,-1.96,-1.93,-1.92,-1.93,-1.91,-1.91,-1.89,-1.9,-1.9,-1.92,-1.9,-1.93,-1.94,-1.97,-1.98,-2.01,-2.02,-2.03,-2.03,-2.06,-2.05,-2.05,-2.08,-2.08,-2.1,-2.13,-2.14,-2.14,-2.17,-2.18,-2.19,-2.2,-2.19,-2.2,-2.22,-2.21,-2.23,-2.22,-2.23,-2.23,-2.24,-2.25,-2.26,-2.25,-2.22,-2.23,-2.19,-2.17,-2.14,-2.12,-2.11,-2.06,-2.04,-2.03,-2,-1.97,-1.94,-1.9,-1.9,-1.88,-1.9,-1.92,-1.97,-2,-2.01,-2.03,-2.04,-2.06,-2.07,-2.1,-2.09,-2.1,-2.13,-2.11,-2.14,-2.14,-2.14,-2.12,-2.12,-2.1,-2.12,-2.14,-2.16,-2.15,-2.18,-2.2,-2.22,-2.21,-2.2,-2.21,-2.22,-2.21,-2.21,-2.19,-2.18,-2.16,-2.12,-2.04,-1.85,-1.79,-1.79,-1.74,-1.69,-1.65,-1.62,-1.44,-1.54,-1.29,-1.14,-1.35,-1.34,-1.28,-1.19,-1.01,-0.9,-0.92,-0.59,-0.47,-0.45,-0.39,-0.14,-0.4,-0.12,-0.26,-0.5,-0.01,-0.45,-0.35,-0.18,-0.37,-0.26,-0.4,-0.36,-0.19,-0.5,-0.29,-0.35,-0.28],
        temperature: ["26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.20","26.30","26.20","26.20","26.20","26.30","26.20","26.20","26.20","26.20","26.30","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20","26.20"],
        vertrates: [-2.48,-2.144,-1.7288,-0.77816,-0.220712,-0.5264984,-0.51254888,-0.814784216,-0.7503489512,-0.63324426584,-0.491270986088,-0.3318896902616,-0.23232278318312,-0.162625948228184,-0.0898381637597287,-0.0988867146318104,-0.153220700242267,-0.179254490169587,-0.125478143118711,-0.0998347001830974,-0.0698842901281682,-0.0489190030897177,-0.0222433021628026,-0.0275703115139616,-0.0192992180597731,-0.00150945264184144,-0.00105661684928901,-0.0247396317945023,-0.0173177422561516,-0.000122419579305862,-8.56937055141036e-05,0.0119400144061399,-0.00364198991570184,-0.00254939294099128,-0.0137845750586942,-0.0216492025410857,-0.00315444177876022,-0.0142081092451319,0.00205432352840742,0.00143802646988519,-0.0109933814710801,0.00430463297024367,0.00301324307917057,-0.00989072984458035,-0.0189235108912065,-0.0252464576238443,-0.0296725203366913,-0.00877076423568362,-0.0301395349649786,-0.00909767447548524,-0.0183683721328394,-0.000857860492987845,0.0113994976549088,0.00797964835843615,0.0415857538509051,0.0411100276956338,0.0407770193869434,0.0285439135708604,0.0199807394996023,0.0259865176497219,0.0421905623548053,0.0535333936483635,0.0374733755538544,0.0142313628876981,0.00996195402138866,-0.017026632185028,-0.0359186425295196,-0.0371430497706635,-0.0380001348394647,-0.038600094387625,-0.0270200660713375,-0.00691404624993652,0.00716016762504471,0.017012117337531,0.0119084821362717,0.0203359374953905,0.00223515624677306,0.00156460937274114,-0.0109047734390809,-0.00763334140735666,0.0186566610148504,0.0370596627103953,0.0139417638972764,0.0217592347280938,0.0152314643096656,0.0106620250167659,-0.00453658248826412,-0.00317560774178488,-0.00222292541924942,-0.00155604779347459,0.0229107665445678,0.0280375365811975,0.0316262756068382,0.0101383929247868,0.00709687504735073,0.0289678125331455,0.0322774687732019,0.0225942281412413,-0.0081840403011311,-0.0297288282107918,-0.056810179747554,-0.0877671258232879,-0.0974369880763018,-0.116205891653411,-0.105344124157388,-0.0737408869101716,-0.11161862083712,-0.102133034585984,-0.107493124210189,-0.123245186947132,-0.0982716308629927,-0.0807901416040946,-0.0565530991228662,-0.0395871693860064,-0.00371101857020442,0.00940228700085665,0.0305816009005997,0.0574071206304195,0.076184984441294,0.0893294891089055,0.0865306423762339,0.096571449663364,0.127600014764355,0.137320010335048,0.144124007234534,0.112886805064174,0.115020763544922,0.116514534481445,0.0935601741370117,0.0534921218959079,0.0614444853271356,0.0430111397289949,0.0541077978102964,0.0258754584672078,0.0181128209270454,-0.0113210253510682,0.0160752822542523,-0.0247473024220237,-0.0293231116954163,-0.0565261781867915,-0.051568324730754,-0.0720978273115276,-0.0624684791180696,-0.0557279353826484,-0.0390095547678539,-0.063306688337498,-0.0323146818362483,-0.0226202772853738,-0.051834194099762,-0.0362839358698334,-0.0493987551088834,-0.0705791285762181,-0.061405390003353,-0.0429837730023471,-0.0660886411016427,-0.0582620487711502,-0.0527834341398049,-0.0489484038978637,-0.0222638827285043,-0.0275847179099533,-0.0433093025369673,-0.0183165117758768,-0.0368215582431138,-0.0137750907701799,-0.0216425635391257,-0.015149794477388,-0.0226048561341719,-0.02782339929392,-0.0314763795057438,-0.0100334656540209,0.0289765740421851,0.00828360182952985,0.0537985212806709,0.0616589648964697,0.0791612754275285,0.07941289279927,0.0675890249594893,0.107312317471642,0.0991186222301496,0.081383035561105,0.0929681248927733,0.101077687424941,0.106754381197459,0.122728066838221,0.0859096467867549,0.0841367527507284,0.0348957269255099,0.000427008847856899,-0.0597010938065002,-0.0777907656645502,-0.0664535359651849,-0.0705174751756294,-0.0613622326229409,-0.0669535628360586,-0.0588674939852408,-0.0772072457896688,-0.0420450720527679,-0.0414315504369378,-0.0650020853058562,-0.0215014597140993,-0.0510510217998698,-0.0357357152599089,-0.0250150006819362,0.00648949952264467,0.00454264966585127,0.0271798547660959,-0.00497410166373288,-0.027481871164613,-0.0432373098152291,-0.0182661168706601,-0.0487862818094624,-0.0581503972666237,-0.0647052780866366,-0.0332936946606453,-0.011305586262452,-0.0199139103837161,-0.0259397372686016,-0.00615781608802082,-0.00431047126161457,0.0209826701168698,0.0266878690818086,0.0426815083572661,0.0778770558500863,0.15051393909506,0.333359757366542,0.30535183015658,0.213746281109606,0.209622396776724,0.206735677743707,0.192714974420595,0.170900482094416,0.335630337466091,0.114941236226264,0.380458865358385,0.446321205750869,0.0604248440256085,0.054297390817926,0.110008173572548,0.185005721500784,0.345504005050549,0.373852803535384,0.237696962474769,0.562387873732338,0.537671511612637,0.400370058128846,0.352259040690192,0.546581328483134,0.070606929938194,0.385424850956736,0.101797395669715,-0.216741823031199,0.43628072387816,-0.222603493285288,-0.0358224452997015,0.178924288290209,-0.102752998196854,0.0600729012622024,-0.125948969116458,-0.0401642783815208,0.175885005132935,-0.248880496406945,0.0777836525151384,-0.0175514432394032,0.0717139897324178,0.134199792812692]
      };
      
      function formatTime(seconds) {
        const minutes = Math.floor(seconds / 60);  // Get full minutes
        const sec = seconds % 60;  // Get the fractional part of the seconds

        // Check if the fractional part is zero
        if (sec % 1 === 0) {
          return `${minutes.toString().padStart(2, '0')}:${Math.floor(sec).toString().padStart(2, '0')}`; // No decimal part if it's zero
        } else {
          return `${minutes.toString().padStart(2, '0')}:${sec.toFixed(2).padStart(5, '0')}`; // With fractional seconds
        }
      }

      // Calculate the time difference (dt) between the first two timestamps
      var dt = dataset.t[1] - dataset.t[0];
      
      dataset.t = dataset.t.map(formatTime);

      // Calculate the number of samples needed to cover 5 seconds
      var tickInterval = Math.round(5 / dt);
      var tickVals = dataset.t.filter((time, index) => index % tickInterval === 0);
      var tickText = tickVals;

      var colors = dataset.vertrates.map(rate => {
        if (rate < 0) {
          return 'dark'+color2;
        } else return 'light'+color2;
      });

      Plotly.react('divePlot', [
        {
          x: dataset.t,
          y: dataset.depth,
          mode: 'lines',
          type: 'scatter',
          name: ylabel1,
          yaxis: 'y',
          line: { color: color1 },
          zorder: 2
        },
        {
          x: dataset.t,
          y: dataset.vertrates,
          mode: 'lines',
          type: 'bar',
          name: ylabel2,
          yaxis: 'y2',
          marker: { color: colors },
          zorder: 1
        }
      ], {
        title: dataset.date + " // " + dataset.time + " // " + dataset.locname,
        showlegend: false,
        xaxis: { 
          title: xlabel,
          tickvals: tickVals,
          ticktext: tickText
        },
        yaxis: { title: ylabel1, side: 'left', titlefont: { color: color1 }, tickfont: { color: color1 } },
        yaxis2: {
          title: ylabel2,
          overlaying: 'y',
          side: 'right',
          titlefont: { color: color2 },
          tickfont: { color: color2 },
          showgrid: false 
        }
      });

      window.addEventListener('resize', function() {
        Plotly.Plots.resize(document.getElementById('divePlot'));
      });

    </script>
  </body>
</html>
