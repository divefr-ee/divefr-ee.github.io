<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="icons/favicon.ico">
    <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="120x120" href="icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="167x167" href="icons/apple-touch-icon-167x167.png">
    <link rel="apple-touch-icon" sizes="512x512" href="icons/apple-touch-icon-512x512.png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>divefree: Ulua Beach</title>
    <script src="/plotly-basic.min.js"></script>
    <style>
        html {
          height: 100%;
          margin: 0;
          overflow: hidden;
        }
        body {
          height: 100%;
          font-family: Arial, sans-serif;
          color: #555;
          overflow-y: auto;
          overflow-x: hidden;
        }
        #divePlot {
          width: 100%;
        }
        #mapPane {
          width: 100%;
        }
    </style>
  </head>
  <body>
    
    <div id="divePlot"></div>
    
    <br/>

    <div id="mapPane">
      <center>
        <iframe
            id="mapIframe"
            width="70%"
            height="200px"
            loading="lazy"
            frameborder="0"
            scrolling="no"
            src="https://www.openstreetmap.org/export/embed.html?bbox=-156.4743%2C20.65886%2C-156.4143%2C20.71886&marker=20.68886,-156.4443">
        </iframe>
      </center>
    </div>
    
    <script>
      const title = '';
      const xlabel = 'time (s)';
      const ylabel1 = 'depth (m)';
      const ylabel2 = 'rate (m/s)';
      const color1 = 'royalblue';
      const color2 = 'grey';
      const dataset = {
        date: "2024-11-23",
        time: "11:11:51",
        lat: 20.68886,
        lon: -156.4443,
        locname: "Ulua Beach",
        t: [0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75,24,24.25,24.5,24.75,25,25.25,25.5,25.75,26,26.25,26.5,26.75,27,27.25,27.5,27.75,28,28.25,28.5,28.75,29,29.25,29.5,29.75,30,30.25,30.5,30.75,31,31.25,31.5,31.75,32,32.25,32.5,32.75,33,33.25,33.5,33.75,34,34.25,34.5,34.75,35,35.25,35.5,35.75,36,36.25,36.5,36.75,37],
        depth: [-0.51,-1.04,-1.25,-1.13,-0.64,-0.83,-0.99,-1.36,-1.82,-1.99,-2.1,-2.18,-2.18,-2.22,-2.28,-2.3,-2.34,-2.39,-2.43,-2.45,-2.41,-2.41,-2.4,-2.4,-2.41,-2.42,-2.44,-2.42,-2.43,-2.44,-2.44,-2.44,-2.41,-2.42,-2.43,-2.41,-2.43,-2.45,-2.37,-2.5,-2.61,-2.73,-2.82,-2.84,-2.83,-2.83,-2.83,-2.87,-2.9,-2.93,-2.96,-2.97,-2.99,-3.01,-2.99,-3,-3,-3,-3.01,-3.02,-3.05,-3.08,-3.08,-3.08,-3.09,-3.07,-3.04,-3.04,-3.02,-3,-3,-2.99,-2.98,-2.99,-2.97,-2.97,-2.96,-2.96,-2.95,-2.94,-2.91,-2.92,-2.9,-2.88,-2.87,-2.85,-2.85,-2.83,-2.81,-2.8,-2.79,-2.8,-2.81,-2.83,-2.85,-2.88,-2.9,-2.94,-2.96,-2.99,-3,-3.02,-3.02,-2.99,-2.97,-2.91,-2.86,-2.81,-2.79,-2.79,-2.69,-2.56,-2.45,-2.35,-2.28,-2.21,-2.13,-2.09,-1.92,-1.65,-1.31,-1.21,-1.23,-1.52,-1.16,-0.85,-1.05,-1.05,-0.73,-0.47,-0.53,-0.19,-0.1,-0.29,-0.24,-0.13,-0.3,-0.23,-0.13,-0.28,-0.19,-0.27,-0.29,0.01,-0.2,-0.24,-0.19,-0.03,-0.39],
        temperature: ["26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30","26.30"],
        vertrates: [-2.12,-1.736,-1.0712,-0.16184,-0.341288,-0.4309016,-0.74563112,-1.073941784,-0.9557592488,-0.80103147416,-0.656722031912,-0.4597054223384,-0.36979379563688,-0.330855656945816,-0.255598959862071,-0.22691927190345,-0.218843490332415,-0.201190443232691,-0.164833310262883,-0.0673833171840183,-0.0471683220288128,-0.0210178254201687,-0.0147124777941181,-0.0222987344558829,-0.0276091141191178,-0.0433263798833825,-0.00632846591836771,-0.0164299261428577,-0.0235009483000001,-0.0164506638100001,-0.0115154646670001,0.0279391747330997,0.00755742231317006,-0.00670980438078123,0.0193031369334532,-0.0104878041465828,-0.031341462902608,0.0740609759681745,-0.104157316822278,-0.204910121775594,-0.287437085242916,-0.309205959670042,-0.240444171769029,-0.15631092023832,-0.109417644166824,-0.0765923509167769,-0.101614645641744,-0.10713025194922,-0.110991176364455,-0.113693823455118,-0.0915856764185823,-0.0881099734930082,-0.0856769814451052,-0.0359738870115742,-0.0371817209081017,-0.0260272046356712,-0.0182190432449698,-0.0247533302714786,-0.0293273311900353,-0.0565291318330245,-0.0755703922831174,-0.0528992745981822,-0.0370294922187275,-0.037920644553109,-0.00254445118717628,0.0342188841689764,0.0239532189182835,0.0407672532427984,0.0525370772699589,0.0367759540889712,0.0377431678622796,0.038420217503596,0.0148941522525169,0.0344259065767624,0.0240981346037337,0.0288686942226133,0.0202080859558293,0.0261456601690803,0.0303019621183565,0.0572113734828493,0.0280479614379948,0.0436335730065963,0.0545435011046175,0.050180450773232,0.0591263155412624,0.0413884208788837,0.0529718946152186,0.061080326230653,0.0547562283614574,0.0503293598530199,0.0232305518971142,0.00426138632797965,-0.0210170295704143,-0.03871192069929,-0.0630983444895028,-0.068168841142652,-0.0957181887998564,-0.0910027321598995,-0.0997019125119299,-0.0817913387583507,-0.0812539371308455,-0.0568777559915919,-0.00381442919411453,0.0213298995641204,0.0869309296948838,0.120851650786419,0.144596155550493,0.125217308885345,0.0876521162197416,0.181356481353819,0.282949536947673,0.330064675863371,0.35104527310436,0.329731691173052,0.314812183821137,0.316368528674796,0.269457970072357,0.39262057905065,0.598834405335455,0.827184083734818,0.699028858614373,0.465320201030061,-0.0222758592789575,0.41640689850473,0.663484828953311,0.224439380267317,0.157107566187122,0.493975296330986,0.65778270743169,0.388447895202183,0.679913526641528,0.58393946864907,0.180757628054349,0.186530339638044,0.262571237746631,-0.0202001335773585,0.0698599064958491,0.168901934547094,-0.061768645817034,0.0647619479280762,-0.0506666364503466,-0.0594666455152426,0.31837334813933,-0.0291386563024689,-0.0683970594117282,0.0121220584117902,0.200485440888253,-0.291660191378223,-0.636162133964756]
      };
      
      function formatTime(seconds) {
        const minutes = Math.floor(seconds / 60);  // Get full minutes
        const sec = seconds % 60;  // Get the fractional part of the seconds

        // Check if the fractional part is zero
        if (sec % 1 === 0) {
          return `${minutes.toString().padStart(2, '0')}:${Math.floor(sec).toString().padStart(2, '0')}`; // No decimal part if it's zero
        } else {
          return `${minutes.toString().padStart(2, '0')}:${sec.toFixed(2).padStart(5, '0')}`; // With fractional seconds
        }
      }

      // Calculate the time difference (dt) between the first two timestamps
      var dt = dataset.t[1] - dataset.t[0];
      
      dataset.t = dataset.t.map(formatTime);

      // Calculate the number of samples needed to cover 5 seconds
      var tickInterval = Math.round(5 / dt);
      var tickVals = dataset.t.filter((time, index) => index % tickInterval === 0);
      var tickText = tickVals;

      var colors = dataset.vertrates.map(rate => {
        if (rate < 0) {
          return 'dark'+color2;
        } else return 'light'+color2;
      });

      Plotly.react('divePlot', [
        {
          x: dataset.t,
          y: dataset.depth,
          mode: 'lines',
          type: 'scatter',
          name: ylabel1,
          yaxis: 'y',
          line: { color: color1 },
          zorder: 2
        },
        {
          x: dataset.t,
          y: dataset.vertrates,
          mode: 'lines',
          type: 'bar',
          name: ylabel2,
          yaxis: 'y2',
          marker: { color: colors },
          zorder: 1
        }
      ], {
        title: dataset.date + " // " + dataset.time + " // " + dataset.locname,
        showlegend: false,
        xaxis: { 
          title: xlabel,
          tickvals: tickVals,
          ticktext: tickText
        },
        yaxis: { title: ylabel1, side: 'left', titlefont: { color: color1 }, tickfont: { color: color1 } },
        yaxis2: {
          title: ylabel2,
          overlaying: 'y',
          side: 'right',
          titlefont: { color: color2 },
          tickfont: { color: color2 },
          showgrid: false 
        }
      });

      window.addEventListener('resize', function() {
        Plotly.Plots.resize(document.getElementById('divePlot'));
      });

    </script>
  </body>
</html>
