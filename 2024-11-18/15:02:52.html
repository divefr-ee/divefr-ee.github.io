<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="icons/favicon.ico">
    <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="120x120" href="icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="167x167" href="icons/apple-touch-icon-167x167.png">
    <link rel="apple-touch-icon" sizes="512x512" href="icons/apple-touch-icon-512x512.png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>divefree: Kahalu'u</title>
    <script src="/plotly-basic.min.js"></script>
    <style>
        html {
          height: 100%;
          margin: 0;
          overflow: hidden;
        }
        body {
          height: 100%;
          font-family: Arial, sans-serif;
          color: #555;
          overflow-y: auto;
          overflow-x: hidden;
        }
        #divePlot {
          width: 100%;
        }
        #mapPane {
          width: 100%;
        }
    </style>
  </head>
  <body>
    
    <div id="divePlot"></div>
    
    <br/>

    <div id="mapPane">
      <center>
        <iframe
            id="mapIframe"
            width="70%"
            height="200px"
            loading="lazy"
            frameborder="0"
            scrolling="no"
            src="https://www.openstreetmap.org/export/embed.html?bbox=-0.1%2C-0.1%2C0.1%2C0.1&marker=0,0">
        </iframe>
      </center>
    </div>
    
    <script>
      const title = '';
      const xlabel = 'time (s)';
      const ylabel1 = 'depth (m)';
      const ylabel2 = 'rate (m/s)';
      const color1 = 'royalblue';
      const color2 = 'darkgrey';
      const dataset = {
        date: "2024-11-18",
        time: "15:02:52",
        lat: 19.57943,
        lon: -155.967011,
        locname: "Kahalu'u",
        t: [0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75,24,24.25,24.5,24.75,25,25.25,25.5,25.75,26,26.25,26.5,26.75,27,27.25,27.5,27.75,28,28.25,28.5,28.75,29,29.25,29.5,29.75,30,30.25,30.5,30.75,31,31.25,31.5,31.75,32,32.25,32.5,32.75,33,33.25,33.5,33.75,34,34.25,34.5,34.75,35,35.25,35.5,35.75,36,36.25,36.5,36.75,37,37.25,37.5,37.75,38,38.25,38.5,38.75,39,39.25,39.5,39.75,40,40.25,40.5,40.75,41,41.25,41.5,41.75,42,42.25,42.5,42.75,43,43.25,43.5,43.75,44,44.25,44.5,44.75,45,45.25,45.5,45.75,46,46.25,46.5,46.75,47,47.25,47.5,47.75,48,48.25,48.5,48.75,49,49.25,49.5,49.75,50,50.25,50.5,50.75,51,51.25,51.5,51.75,52,52.25,52.5,52.75,53,53.25,53.5,53.75,54,54.25,54.5,54.75,55,55.25,55.5,55.75,56,56.25,56.5,56.75,57,57.25,57.5,57.75,58,58.25,58.5,58.75,59,59.25,59.5,59.75,60,60.25,60.5,60.75,61,61.25,61.5,61.75,62,62.25,62.5,62.75,63,63.25],
        depth: [-1.04,-1.31,-1.34,-1.29,-0.99,-0.83,-1.36,-1.07,-1.63,-1.46,-1.3,-1.44,-1.56,-2.28,-2.61,-2.91,-3.11,-3.13,-3.32,-3.59,-3.77,-3.87,-4.05,-4.23,-4.36,-4.46,-4.46,-4.41,-4.09,-3.9,-4.48,-4.81,-4.5,-4.28,-4.77,-4.94,-4.91,-4.92,-4.92,-4.93,-4.93,-4.95,-4.94,-4.92,-4.93,-4.91,-4.92,-4.91,-4.9,-4.89,-4.87,-4.85,-4.84,-4.8,-4.79,-4.78,-4.76,-4.77,-4.76,-4.76,-4.76,-4.77,-4.78,-4.79,-4.79,-4.82,-4.83,-4.85,-4.85,-4.88,-4.91,-4.92,-4.94,-4.96,-4.97,-5.01,-4.98,-4.96,-4.94,-5,-5.07,-5.16,-5.19,-5.2,-5.23,-5.23,-5.21,-5.14,-5.1,-4.99,-4.86,-4.71,-4.56,-4.49,-4.41,-4.29,-4.22,-4.22,-4.25,-4.31,-4.34,-4.32,-4.25,-4.16,-4.11,-4.05,-4.03,-4.01,-3.95,-3.85,-3.75,-3.71,-3.82,-4,-4.08,-4.14,-4.2,-4.26,-4.32,-4.39,-4.47,-4.56,-4.65,-4.78,-4.89,-5,-5.07,-5.14,-5.17,-5.18,-5.22,-5.22,-5.24,-5.23,-5.21,-5.22,-5.23,-5.23,-5.22,-5.21,-5.18,-5.15,-5.11,-5.05,-5.05,-5.1,-5.07,-5.04,-5.03,-5.02,-5.01,-5.01,-5.01,-5.01,-4.99,-4.99,-4.97,-4.96,-4.9,-4.84,-4.79,-4.75,-4.67,-4.51,-4.46,-4.44,-4.28,-4.1,-4.1,-4.29,-4.38,-4.49,-4.25,-4.16,-4.42,-4.42,-4.37,-4.36,-4.33,-4.27,-4.22,-4.22,-4.07,-4.07,-4.1,-4.19,-4.14,-3.91,-4.06,-4.16,-3.83,-3.86,-3.71,-3.65,-3.7,-3.81,-3.65,-3.99,-3.84,-3.79,-3.78,-3.79,-3.69,-3.63,-3.56,-3.47,-3.47,-3.39,-3.35,-3.37,-3.3,-3.26,-3.14,-3.1,-3.01,-3.02,-3.02,-2.93,-2.88,-2.71,-2.56,-2.62,-2.55,-2.45,-2.3,-2.12,-2.04,-1.89,-1.66,-1.49,-1.29,-1.07,-0.85,-0.51,-0.35,-0.21,-0.2,-0.32,-0.47,-0.68,-0.49,-0.42,-0.3,-0.31,-0.67,-0.45,-0.29,-0.24,-0.62,-0.51,-0.32,-0.28,-0.45],
        temperature: ["27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.30","27.20","27.20","27.30","27.30","27.30","27.30","27.30","27.20","27.20","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.20","27.30","27.30","27.20","27.30","27.30","27.20","27.20","27.20","27.20","27.20","27.30","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.20","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10","27.10"],
        vertrates: [-1.08,-0.792,-0.4944,0.0139200000000001,0.201744,-0.4947792,0.00165455999999986,-0.670841808,-0.2655892656,0.00608751407999988,-0.163738740144,-0.2586171181008,-1.04503198267056,-1.12752238786939,-1.14926567150857,-1.044485970056,-0.755140179039201,-0.756598125327441,-0.853618687729208,-0.813533081410446,-0.689473156987312,-0.698631209891118,-0.705041846923783,-0.649529292846648,-0.574670504992653,-0.402269353494857,-0.2215885474464,0.22888801678752,0.388221611751264,-0.424244871774116,-0.692971410241881,-0.113079987169316,0.184844008981478,-0.458609193712964,-0.525026435599076,-0.331518504919353,-0.244062953443547,-0.170844067410483,-0.131590847187338,-0.0921135930311363,-0.088479515121796,-0.0499356605852574,-0.0109549624096797,-0.0196684736867755,0.0102320684192566,-0.0048375521065201,0.00861371352543567,0.0180295994678047,0.0246207196274641,0.0412345037392244,0.0528641526174576,0.0490049068322201,0.0823034347825541,0.0696124043477876,0.0607286830434511,0.0665100781304163,0.0345570546912917,0.0361899382839039,0.0253329567987327,0.0177330697591129,0.000413148831379292,-0.0117107958180353,-0.0201975570726245,-0.0141382899508371,-0.0458968029655863,-0.0441277620759101,-0.0548894334531366,-0.0384226034171956,-0.0628958223920372,-0.0800270756744264,-0.0680189529720982,-0.0716132670804693,-0.074129286956328,-0.0638905008694293,-0.0927233506086006,-0.0289063454260212,0.00376555820178574,0.0266358907412495,-0.0533548764811249,-0.121348413536788,-0.192943889475751,-0.171060722633026,-0.131742505843118,-0.128219754090183,-0.089753827863128,-0.0388276795041891,0.056820624347068,0.0877744370429476,0.193442105930063,0.291409474151044,0.383986631905731,0.448790642334011,0.398153449633808,0.374707414743666,0.406295190320566,0.368406633224397,0.257884643257078,0.144519250279954,0.0291634751959683,-0.0155855673628225,0.0130901028460237,0.0931630719922169,0.173214150394552,0.181249905276186,0.198874933693331,0.163212453585331,0.138248717509732,0.168774102256812,0.238141871579769,0.286699310105838,0.248689517074087,0.0420826619518603,-0.186542136633697,-0.226579495643588,-0.230605646950511,-0.233423952865359,-0.23539676700575,-0.236777736904026,-0.249744415832817,-0.270821091082972,-0.297574763758081,-0.316302334630657,-0.37741163424146,-0.396188143969021,-0.409331700778315,-0.370532190544821,-0.343372533381374,-0.276360773366962,-0.205452541356873,-0.191816778949811,-0.134271745264868,-0.117990221685408,-0.0705931551797859,-0.0254152086258495,-0.0297906460380944,-0.0328534522266669,-0.0229974165586668,-0.00409819159106597,0.00913126588625356,0.0423918861203778,0.0656743202842637,0.0939720241989846,0.13778041693929,0.0964462918575029,0.00751240430025223,0.0412586830101758,0.0648810781071233,0.0574167546749861,0.0521917282724911,0.0485342097907435,0.0339739468535204,0.0237817627974643,0.016647233958225,0.035653063770757,0.0249571446395299,0.0414700012476715,0.0410290008733698,0.100720300611358,0.142504210427951,0.159752947299566,0.159827063109696,0.207878944176787,0.337515260923751,0.296260682646626,0.231382477852637,0.353967734496846,0.463777414147793,0.324644189903455,-0.000749067067581849,-0.108524346947307,-0.207967042863115,0.14242306999582,0.207696148997074,-0.166612695702048,-0.116628886991434,-0.0216402208940039,-0.00314815462580296,0.0337962917619382,0.0956574042333573,0.12696018296335,0.0888721280743449,0.242210489652041,0.169547342756429,0.0826831399295007,-0.0501218020493504,0.0249147385654556,0.293440316995818,0.0254082218970735,-0.102214244672049,0.324450028729566,0.191115020110696,0.313780514077487,0.291646359854241,0.144152451897968,-0.0310932836714219,0.170234701430005,-0.288835708998997,-0.0221849962992975,0.0444705025904915,0.0431293518133438,0.0181905462693409,0.132733382388539,0.164913367671977,0.199439357370384,0.247607550159268,0.173325285111488,0.217327699578042,0.200129389704629,0.11609057279324,0.165263400955269,0.163684380668688,0.258579066468081,0.229005346527657,0.26830374256936,0.175812619798552,0.123068833858986,0.19414818370129,0.195903728590903,0.341132610013632,0.418792827009542,0.22115497890668,0.238808485234676,0.287165939664273,0.381016157764991,0.482711310435494,0.433897917304846,0.483728542113392,0.614609979479374,0.634226985635562,0.683958889944893,0.742771222961425,0.783939856072998,0.956757899251098,0.861730529475769,0.771211370633038,0.551847959443127,0.242293571610189,-0.0103944998728679,-0.259276149911008,0.0465066950622948,0.116554686543606,0.225588280580524,0.145911796406367,-0.329861742515543,0.0330967802391199,0.215167746167384,0.210617422317169,-0.308567804377982,-0.0839974630645873,0.169201775854789,0.166441243098352,-0.0874911298311535,-0.265243790881807]
      };
      function updatePlot() {
        var colors = dataset.vertrates.map(rate => {
          if (rate < 0) {
            return 'darkgrey';
          } else return 'lightgrey';
        });

        Plotly.react('divePlot', [
          {
            x: dataset.t,
            y: dataset.depth,
            mode: 'lines',
            type: 'scatter',
            name: ylabel1,
            yaxis: 'y',
            line: { color: color1 },
            zorder: 2
          },
          {
            x: dataset.t,
            y: dataset.vertrates,
            mode: 'lines',
            type: 'bar',
            name: ylabel2,
            yaxis: 'y2',
            marker: { color: colors },
            line: { color: color2 },
            zorder: 1
          }
        ], {
          title: dataset.date + " // " + dataset.time + " // " + dataset.locname,
          showlegend: false,
          xaxis: { title: xlabel },
          yaxis: { title: ylabel1, side: 'left', titlefont: { color: color1 }, tickfont: { color: color1 } },
          yaxis2: {
            title: ylabel2,
            overlaying: 'y',
            side: 'right',
            titlefont: { color: color2 },
            tickfont: { color: color2 },
            showgrid: false // Optional: Hide the grid for the right Y-axis
          }
        });

        // Update the iframe URL with new coordinates and bbox
        const lat = dataset.lat;
        const lon = dataset.lon;
        if (lat && lon ){
          const newBBox = `${lon - 0.03}%2C${lat - 0.03}%2C${lon + 0.03}%2C${lat + 0.03}`;
          const newMarker = `${lat},${lon}`;
          const newIframeSrc = `https://www.openstreetmap.org/export/embed.html?bbox=${newBBox}&marker=${newMarker}`;
          document.getElementById('mapIframe').src = newIframeSrc;
        }else{
          document.getElementById('mapIframe').src = ``;
        }
      }

      // Initial plot with the first dataset
      updatePlot();

      // Resize plot on window resize
      window.addEventListener('resize', function() {
        checkOrientation();
        Plotly.Plots.resize(document.getElementById('divePlot'));
      });
    </script>
  </body>
</html>
