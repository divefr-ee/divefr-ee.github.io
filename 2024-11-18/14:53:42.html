<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="icons/favicon.ico">
    <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="120x120" href="icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="167x167" href="icons/apple-touch-icon-167x167.png">
    <link rel="apple-touch-icon" sizes="512x512" href="icons/apple-touch-icon-512x512.png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>divefree: Kahalu'u</title>
    <script src="/plotly-basic.min.js"></script>
    <style>
        html {
          height: 100%;
          margin: 0;
          overflow: hidden;
        }
        body {
          height: 100%;
          font-family: Arial, sans-serif;
          color: #555;
          overflow-y: auto;
          overflow-x: hidden;
        }
        #divePlot {
          width: 100%;
        }
        #mapPane {
          width: 100%;
        }
    </style>
  </head>
  <body>
    
    <div id="divePlot"></div>
    
    <br/>

    <div id="mapPane">
      <center>
        <iframe
            id="mapIframe"
            width="70%"
            height="200px"
            loading="lazy"
            frameborder="0"
            scrolling="no"
            src="https://www.openstreetmap.org/export/embed.html?bbox=-155.997011%2C19.54943%2C-155.937011%2C19.60943&marker=19.57943,-155.967011">
        </iframe>
      </center>
    </div>
    
    <script>
      const title = '';
      const xlabel = 'time (s)';
      const ylabel1 = 'depth (m)';
      const ylabel2 = 'rate (m/s)';
      const color1 = 'royalblue';
      const color2 = 'grey';
      const dataset = {
        date: "2024-11-18",
        time: "14:53:42",
        lat: 19.57943,
        lon: -155.967011,
        locname: "Kahalu'u",
        t: [0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75,24,24.25,24.5,24.75,25,25.25,25.5,25.75,26,26.25,26.5,26.75,27,27.25,27.5,27.75,28,28.25,28.5,28.75,29,29.25,29.5,29.75,30,30.25,30.5,30.75,31,31.25,31.5,31.75,32,32.25,32.5,32.75,33,33.25,33.5,33.75,34,34.25,34.5,34.75,35,35.25,35.5,35.75,36,36.25,36.5,36.75,37,37.25,37.5,37.75,38,38.25,38.5,38.75,39,39.25,39.5,39.75,40,40.25,40.5,40.75,41,41.25,41.5,41.75,42,42.25,42.5,42.75,43,43.25,43.5,43.75,44,44.25,44.5,44.75,45,45.25,45.5,45.75,46,46.25,46.5,46.75,47,47.25,47.5,47.75,48,48.25,48.5,48.75,49,49.25,49.5,49.75,50,50.25,50.5,50.75,51,51.25,51.5,51.75,52,52.25,52.5,52.75,53,53.25,53.5,53.75,54,54.25,54.5,54.75,55,55.25,55.5,55.75,56,56.25,56.5,56.75,57,57.25,57.5,57.75,58,58.25,58.5,58.75,59,59.25,59.5,59.75,60,60.25,60.5,60.75,61,61.25,61.5,61.75,62,62.25,62.5,62.75,63,63.25,63.5,63.75,64,64.25,64.5,64.75,65,65.25,65.5,65.75,66,66.25,66.5,66.75,67,67.25,67.5,67.75,68],
        depth: [-1.07,-1.16,-1.15,-1.1,-0.71,-0.62,-0.83,-1.39,-1.82,-1.94,-2.05,-2.05,-1.97,-1.94,-2.01,-2.09,-2.05,-1.99,-2.06,-1.9,-1.9,-1.82,-1.82,-1.85,-1.86,-1.79,-1.44,-1.72,-1.93,-2.08,-2.18,-2.39,-2.48,-2.48,-2.45,-2.42,-2.41,-2.38,-2.39,-2.35,-2.32,-2.29,-2.26,-2.28,-2.27,-2.3,-2.35,-2.38,-2.41,-2.43,-2.42,-2.41,-2.36,-2.22,-2.18,-2.13,-2.13,-2.14,-2.12,-2.11,-2.1,-2.08,-2.06,-2.05,-2.05,-2.04,-2.09,-2.11,-2.14,-2.16,-2.16,-2.18,-2.2,-2.21,-2.23,-2.24,-2.26,-2.24,-2.25,-2.24,-2.27,-2.33,-2.37,-2.4,-2.42,-2.44,-2.44,-2.42,-2.37,-2.35,-2.33,-2.31,-2.3,-2.29,-2.3,-2.3,-2.32,-2.34,-2.37,-2.4,-2.43,-2.44,-2.44,-2.42,-2.39,-2.36,-2.29,-2.23,-2.1,-2.05,-2.05,-2.06,-2.1,-2.14,-2.14,-2.12,-2.11,-2.09,-2.06,-2,-1.96,-1.93,-1.88,-1.87,-1.92,-1.96,-2,-2.06,-2.1,-2.12,-2.14,-2.15,-2.13,-2.1,-2.08,-2.08,-2.1,-2.1,-2.15,-2.19,-2.22,-2.26,-2.31,-2.35,-2.35,-2.37,-2.31,-2.26,-2.22,-2.16,-2.13,-2.11,-2.14,-2.18,-2.2,-2.23,-2.27,-2.25,-2.26,-2.24,-2.21,-2.19,-2.16,-2.12,-2.1,-2.07,-2.06,-2.07,-2.06,-2.05,-2.06,-2.05,-1.97,-2.02,-2.06,-2.07,-2.09,-2.13,-2.15,-2.15,-2.18,-2.19,-2.21,-2.22,-2.25,-2.26,-2.27,-2.29,-2.33,-2.35,-2.38,-2.37,-2.35,-2.32,-2.29,-2.21,-2.14,-2.07,-2.04,-2.03,-2.02,-2.05,-2.07,-2.1,-2.11,-2.14,-2.17,-2.17,-2.17,-2.15,-2.09,-2.08,-2.07,-2.09,-2.07,-2.04,-2.08,-2.16,-2.18,-2.29,-2.35,-2.37,-2.39,-2.38,-2.38,-2.39,-2.4,-2.41,-2.4,-2.38,-2.36,-2.35,-2.36,-2.34,-2.34,-2.3,-2.26,-2.18,-2.12,-2.13,-2.15,-2.15,-2.23,-2.28,-2.3,-2.04,-1.86,-1.66,-1.47,-1.26,-1.08,-0.97,-0.76,-0.48,-0.31,-0.14,-0.26,-0.27,-0.18,-0.22,-0.09,-0.16,-0.27,-0.26,-0.04,-0.35,-0.33,-0.19,-0.16,-0.45,-0.39,-0.19,-0.39],
        temperature: ["27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.50","27.40","27.40","27.50","27.50","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.30","27.40","27.40","27.40","27.40","27.30","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.40","27.30","27.40","27.40","27.40","27.40","27.40","27.40","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30","27.30"],
        vertrates: [-0.359999999999999,-0.24,-0.108,0.3924,0.38268,0.0158759999999999,-0.6608868,-0.97862076,-0.829034532,-0.7123241724,-0.49862692068,-0.253038844476,-0.1411271911332,-0.18278903379324,-0.223952323655268,-0.108766626558687,-0.00413663859108143,-0.0868956470137571,0.13117304709037,0.0918211329632592,0.160274793074281,0.112192355151997,0.0425346486063977,0.0177742540244787,0.0964419778171349,0.487509384471995,0.00525656913039613,-0.248320401608723,-0.353824281126106,-0.367676996788274,-0.509373897751792,-0.464561728426254,-0.325193209898378,-0.191635246928865,-0.098144672850205,-0.0567012709951437,-0.00369088969660032,-0.0145836227876205,0.0377914640486657,0.0624540248340663,0.0797178173838461,0.0918024721686926,0.0402617305180843,0.0401832113626593,-0.00787175204613829,-0.0655102264322971,-0.0818571585026077,-0.0933000109518257,-0.089310007666278,-0.0505170053663943,-0.0233619037564763,0.0436466673704669,0.198552667159326,0.186986867011529,0.19089080690807,0.133623564835649,0.0815364953849542,0.0810755467694679,0.0687528827386278,0.0601270179170392,0.0660889125419275,0.0702622387793493,0.0611835671455448,0.0428284970018813,0.0419799479013167,-0.0306140364690781,-0.0454298255283547,-0.0678008778698486,-0.071460614508894,-0.0500224301562258,-0.0590157011093581,-0.0653109907765507,-0.0577176935435852,-0.0644023854805097,-0.057081669836357,-0.0639571688854494,-0.0207700182198151,-0.0265390127538703,-0.00657730892770948,-0.0406041162493964,-0.100422881374578,-0.118296016962204,-0.118807211873543,-0.10716504831148,-0.099015533818036,-0.0693108736726252,-0.0245176115708376,0.0428376719004135,0.0539863703302894,0.0617904592312026,0.0672533214618418,0.0590773250232896,0.0533541275163024,0.025347889261412,0.0177435224829884,-0.0115795342619082,-0.0321056739833357,-0.0584739717883353,-0.0769317802518345,-0.0898522461762844,-0.0748965723233988,-0.0524276006263792,-0.0126993204384654,0.027110475693074,0.0549773329851521,0.122484133089606,0.157738893162724,0.266417225213907,0.246492057649735,0.172544440354815,0.10878110824837,0.0281467757738589,-0.0282972569582988,-0.0198080798708092,0.0101343440904336,0.0190940408633038,0.0373658286043127,0.0621560800230186,0.115509256016113,0.128856479211279,0.126199535447895,0.148339674813527,0.115837772369469,0.0210864406586282,-0.0332394915389603,-0.0712676440772722,-0.121887350854091,-0.133321145597863,-0.117324801918504,-0.106127361342953,-0.0862891529400669,-0.0364024070580468,0.010518315059367,0.0313628205415569,0.0219539743790898,-0.00863221793463714,-0.006042552554246,-0.064229786787972,-0.0929608507515804,-0.101072595526107,-0.118750816868274,-0.143125571807792,-0.148187900265455,-0.103731530185818,-0.0966120711300728,0.00437155020894914,0.0630600851462647,0.0921420596023848,0.136499441721669,0.131549609205169,0.116084726443618,0.0452593085105325,-0.0163184840426273,-0.0354229388298391,-0.0607960571808872,-0.090557240026621,-0.0393900680186347,-0.039573047613044,-0.00370113332913133,0.0334092066696084,0.0473864446687259,0.0691705112681079,0.0964193578876756,0.0914935505213729,0.100045485364961,0.0820318397554727,0.0454222878288311,0.0437956014801815,0.0426569210361273,0.0178598447252889,0.0245018913077025,0.113151323915392,0.019205926740774,-0.0345558512814582,-0.0361890958970205,-0.0493323671279144,-0.0825326569895401,-0.0817728598926781,-0.0572410019248747,-0.0760687013474126,-0.0652480909431885,-0.069673663660232,-0.0607715645621627,-0.0785400951935136,-0.0669780666354593,-0.0588846466448218,-0.0652192526513753,-0.0936534768559627,-0.0895574337991739,-0.0986902036594215,-0.0570831425615953,-0.0159581997931167,0.0248292601448186,0.0533804821013728,0.133366337470961,0.177356436229673,0.208149505360771,0.181704653752539,0.139193257626778,0.109435280338744,0.0406046962371212,0.00442328736598484,-0.0329036988438109,-0.0350325891906674,-0.0605228124334675,-0.078365968703427,-0.0548561780923989,-0.0383993246646792,-0.00287952726527543,0.0699843309143073,0.0609890316400148,0.0546923221480107,0.0142846255036074,0.0339992378525252,0.0597994664967674,-0.00614037345226286,-0.100298261416584,-0.0942087829916089,-0.197946148094126,-0.210562303665888,-0.171393612566122,-0.143975528796285,-0.0887828701573994,-0.0621480091101796,-0.055503606377126,-0.0508525244639879,-0.0475967671247918,-0.021317736987354,0.00907758410885222,0.0303543088761966,0.0332480162133373,0.0112736113493364,0.0318915279445355,0.0223240695611748,0.0636268486928224,0.0925387940849758,0.160777155859483,0.184544009101638,0.117180806371147,0.0580265644598027,0.0406185951218619,-0.0675669834146968,-0.107296888390288,-0.0991078218732011,0.242624524688759,0.385837167282131,0.510086017097492,0.585060211968244,0.661542148377771,0.67907950386444,0.607355652705108,0.677148956893575,0.810004269825503,0.771002988877852,0.743702092214496,0.376591464550147,0.251614025185103,0.284129817629572,0.150890872340701,0.26162361063849,0.0991365274469432,-0.0626044307871397,-0.0318231015509978,0.241723828914302,-0.202793319759989,-0.117955323831992,0.0854312733176054,0.0958018913223238,-0.280938676074373,-0.124657073252061,0.152740048723557,-0.13308196589351,-0.333157376125457]
      };
      
      function formatTime(seconds) {
        const minutes = Math.floor(seconds / 60);  // Get full minutes
        const sec = seconds % 60;  // Get the fractional part of the seconds

        // Check if the fractional part is zero
        if (sec % 1 === 0) {
          return `${minutes.toString().padStart(2, '0')}:${Math.floor(sec).toString().padStart(2, '0')}`; // No decimal part if it's zero
        } else {
          return `${minutes.toString().padStart(2, '0')}:${sec.toFixed(2).padStart(5, '0')}`; // With fractional seconds
        }
      }

      // Calculate the time difference (dt) between the first two timestamps
      var dt = dataset.t[1] - dataset.t[0];
      
      dataset.t = dataset.t.map(formatTime);

      // Calculate the number of samples needed to cover 5 seconds
      var tickInterval = Math.round(5 / dt);
      var tickVals = dataset.t.filter((time, index) => index % tickInterval === 0);
      var tickText = tickVals;

      var colors = dataset.vertrates.map(rate => {
        if (rate < 0) {
          return 'dark'+color2;
        } else return 'light'+color2;
      });

      Plotly.react('divePlot', [
        {
          x: dataset.t,
          y: dataset.depth,
          mode: 'lines',
          type: 'scatter',
          name: ylabel1,
          yaxis: 'y',
          line: { color: color1 },
          zorder: 2
        },
        {
          x: dataset.t,
          y: dataset.vertrates,
          mode: 'lines',
          type: 'bar',
          name: ylabel2,
          yaxis: 'y2',
          marker: { color: colors },
          zorder: 1
        }
      ], {
        title: dataset.date + " // " + dataset.time + " // " + dataset.locname,
        showlegend: false,
        xaxis: { 
          title: xlabel,
          tickvals: tickVals,
          ticktext: tickText
        },
        yaxis: { title: ylabel1, side: 'left', titlefont: { color: color1 }, tickfont: { color: color1 } },
        yaxis2: {
          title: ylabel2,
          overlaying: 'y',
          side: 'right',
          titlefont: { color: color2 },
          tickfont: { color: color2 },
          showgrid: false 
        }
      });

      window.addEventListener('resize', function() {
        Plotly.Plots.resize(document.getElementById('divePlot'));
      });

    </script>
  </body>
</html>
